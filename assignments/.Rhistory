high = "#C8A2C8",
mid  = "#B0E0E6",
low  = "#C1E1C1",
midpoint = 0,
guide = "none"
) +
ylab("Loading strength") +
xlab(NULL) +
theme_bw(base_size = 10)
factor_scores <- as.data.frame(efa2$scores)
colnames(factor_scores) <- c("Animal_rights", "Animal_research")
arq_fa_comm_scored <- bind_cols(arq_fa_comm, factor_scores)
View(arq_fa_comm_scored)
arq_scored <- arq %>%
select(-c(3, 8, 10, 14, 16, 22, 26, 28))
arq_fa_regression <- bind_cols(arq_scored, factor_scores)
View(arq_fa_regression)
arq_scored <- arq_new %>%
select(-c(3, 8, 10, 14, 16, 22, 26, 28))
arq_fa_regression <- bind_cols(arq_scored, factor_scores)
View(arq_fa_regression)
tab3 <- cbind(loadings_mat2, h2_2 = round(h2_2, 2))
tab3 <- tab3 %>%
rownames_to_column(var = "Item") %>%
mutate(
Factor = case_when(
abs(F1) >= abs(F2) ~ "Animal rights",
abs(F2) > abs(F1)  ~ "Animal research"
)
) %>%
arrange(desc(h2_2))
loadings_plot <- tab3 %>%
pivot_longer(
cols = c(F1, F2),
names_to = "LatentFactor",
values_to = "Loading"
) %>%
# keep only the primary loading for each item
filter(
(Factor == "Animal rights"  & LatentFactor == "F1") |
(Factor == "Animal research" & LatentFactor == "F2")
)
ggplot(loadings_plot, aes(Item, abs(Loading), fill = Loading)) +
facet_wrap(~ Factor, nrow = 1) +
geom_bar(stat = "identity") +
coord_flip() +
scale_fill_gradient2(
name = "Loading",
high = "#C8A2C8",
mid  = "#B0E0E6",
low  = "#C1E1C1",
midpoint = 0,
guide = "none"
) +
ylab("Loading strength") +
xlab(NULL) +
theme_bw(base_size = 10)
tab3 <- cbind(loadings_mat2, h2_2 = round(h2_2, 2))
tab3 <- tab3 %>%
rownames_to_column(var = "Item") %>%
mutate(
Factor = case_when(
abs(F1) >= abs(F2) ~ "Animal rights",
abs(F2) > abs(F1)  ~ "Animal research"
)
) %>%
arrange(desc(h2_2))
loadings_plot <- tab3 %>%
pivot_longer(
cols = c(F1, F2),
names_to = "LatentFactor",
values_to = "Loading"
) %>%
# keep only the primary loading for each item
filter(
(Factor == "Animal rights"  & LatentFactor == "F1") |
(Factor == "Animal research" & LatentFactor == "F2")
)
ggplot(loadings_plot, aes(Item, abs(Loading), fill = Loading)) +
facet_wrap(~ Factor, nrow = 1) +
geom_bar(stat = "identity") +
coord_flip() +
scale_fill_gradient2(
name = "Loading",
high = "#C8A2C8",
mid  = "#B0E0E6",
low  = "#C1E1C1",
midpoint = 0,
guide = "none"
) + labs(title = "Factor structure",
x = "Items, arranged according to communality scores (highest to lowest)",
y = "Loading strength") +
theme_bw(base_size = 10)
View(arq_fa_regression)
model_lm <- lm(
liberal ~ Animal_rights + Animal_research,
data = arq_fa_regression
)
summary(model_lm)
regression <- lm(
liberal ~ Animal_rights + Animal_research,
data = arq_fa_regression
)
summary(model_lm)
View(regression)
correlation1
corrplot(correlation1, method = "color",
type = "upper",
tl.col = "black",
tl.srt = 45,
addCoef.col = "black",
number.cex = 0.7,
diag = FALSE)
efa2
library(tidyverse)
library(readxl)
library(car)
library(corrplot)
arq <- read_xlsx("/Users/illesanna/Desktop/DOKUMENTUMOK/ELTE/MESTER/semester1/data_analysis_r/KPTUXW_interim_assignments/KPTUXW_interim_assignments/data/assignment_3_dataset.xlsx")
df <- read_xlsx("/Users/illesanna/Desktop/DOKUMENTUMOK/ELTE/MESTER/semester1/data_analysis_r/KPTUXW_interim_assignments/KPTUXW_interim_assignments/data/assignment_3_dataset.xlsx")
View(df)
View(df)
glimpse(df %>% select(-ID))
summary(df %>% select(-ID))
df_desc <- df %>%
select(-ID) %>%
summarise(
across(where(is.numeric),
list(
mean = ~mean(.x, na.rm = TRUE),
sd   = ~sd(.x, na.rm = TRUE),
min  = ~min(.x, na.rm = TRUE),
max  = ~max(.x, na.rm = TRUE)
))
)
df_desc
View(df_desc)
View(df)
summary(df %>% select(-ID))
df_clean <- df %>%
mutate(mindfulness = if_else(mindfulness > 6, 6, mindfulness))
View(df_clean)
glimpse(df %>% select(-ID))
summary(df %>% select(-ID))
df_desc <- df %>%
select(-ID) %>%
summarise(
across(where(is.numeric),
list(
mean = ~mean(.x, na.rm = TRUE),
sd   = ~sd(.x, na.rm = TRUE),
min  = ~min(.x, na.rm = TRUE),
max  = ~max(.x, na.rm = TRUE)
))
)
df_desc
sapply(df, function(x) sum(is.na(x)))
df_box <- df_clean %>%
pivot_longer(cols = everything(),
names_to = "variable",
values_to = "value") %>%
ggplot(aes(x = variable, y = value)) +
geom_boxplot(outlier.colour = "red") +
coord_flip() +
theme_bw() +
labs(
title = "Boxplots for all variables",
x = NULL,
y = "Value"
)
df_box <- df_clean %>%
pivot_longer(cols = where(is.numeric()),
names_to = "variable",
values_to = "value") %>%
ggplot(aes(x = variable, y = value)) +
geom_boxplot(outlier.colour = "red") +
coord_flip() +
theme_bw() +
labs(
title = "Boxplots for all variables",
x = NULL,
y = "Value"
)
df_box
df_box <- df_clean %>%
pivot_longer(cols = where(is.numeric()),
names_to = "variable",
values_to = "value")
num <- dat %>%
select(where(is.numeric))
num <- df_clean %>%
select(where(is.numeric))
par(mfrow = c(3, 3))
for (v in names(num)) {
boxplot(num[[v]], main = v, col = "lightblue")
}
par(mfrow = c(1, 1))
m0 <- lm(pain ~ age + sex, data = df_clean)
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
df_clean <- df %>%
mutate(mindfulness = if_else(mindfulness > 6, 6, mindfulness)) %>%
mutate(sex = case_when(
sex == "male"   ~ 1,
sex == "female" ~ 2)
)
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
num <- df_clean %>%
select(where(is.numeric))
par(mfrow = c(3, 3))
for (v in names(num)) {
boxplot(num[[v]], main = v, col = "lightblue")
}
par(mfrow = c(1, 1))
df_clean <- df %>%
mutate(mindfulness = if_else(mindfulness > 6, 6, mindfulness)) %>%
mutate(sex = case_when(
sex == "male"   ~ 0,
sex == "female" ~ 1)
)
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
num <- df_clean %>%
select(where(is.numeric))
par(mfrow = c(3, 3))
for (v in names(num)) {
boxplot(num[[v]], main = v, col = "lightblue")
}
par(mfrow = c(1, 1))
m0
plot(m0, which = 1)
car::vif(m0)
qqnorm(resid(m0))
qqline(resid(m0), col = "red")
car::vif(m0)
shapiro.test(resid(m0))
plot(m0, which = 1)
par(mfrow=c(2,2)); plot(m0); par(mfrow=c(1,1))
check_model(m0)
plot(m0, which = 1)
library(tidyverse)
library(readxl)
library(car)
library(corrplot)
library(lmtest)
# Chunk 1: setup
library(tidyverse)
library(readxl)
library(car)
library(corrplot)
library(lmtest)
# Chunk 2: read
df <- read_xlsx("/Users/illesanna/Desktop/DOKUMENTUMOK/ELTE/MESTER/semester1/data_analysis_r/KPTUXW_interim_assignments/KPTUXW_interim_assignments/data/assignment_3_dataset.xlsx")
# Chunk 3
glimpse(df %>% select(-ID))
summary(df %>% select(-ID))
df_desc <- df %>%
select(-ID) %>%
summarise(
across(where(is.numeric),
list(
mean = ~mean(.x, na.rm = TRUE),
sd   = ~sd(.x, na.rm = TRUE),
min  = ~min(.x, na.rm = TRUE),
max  = ~max(.x, na.rm = TRUE)
))
)
df_desc
sapply(df, function(x) sum(is.na(x)))
# Chunk 4
df_clean <- df %>%
mutate(mindfulness = if_else(mindfulness > 6, 6, mindfulness)) %>%
mutate(sex = case_when(
sex == "male"   ~ 0,
sex == "female" ~ 1)
)
# Chunk 5
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
# Chunk 6
plot(m0, which = 1)
# Chunk 7
qqnorm(resid(m0))
qqline(resid(m0), col = "red")
shapiro.test(resid(m0))
# Chunk 8
# Chunk 9
lmtest::bptest(m0)
# Chunk 10
car::vif(m0)
# Chunk 11
df_with_resid <- df %>%
mutate(resid = residuals(m0))
rlang::last_trace()
# Chunk 1: setup
library(tidyverse)
library(readxl)
library(car)
library(corrplot)
library(lmtest)
# Chunk 2: read
df <- read_xlsx("/Users/illesanna/Desktop/DOKUMENTUMOK/ELTE/MESTER/semester1/data_analysis_r/KPTUXW_interim_assignments/KPTUXW_interim_assignments/data/assignment_3_dataset.xlsx")
# Chunk 3
glimpse(df %>% select(-ID))
summary(df %>% select(-ID))
df_desc <- df %>%
select(-ID) %>%
summarise(
across(where(is.numeric),
list(
mean = ~mean(.x, na.rm = TRUE),
sd   = ~sd(.x, na.rm = TRUE),
min  = ~min(.x, na.rm = TRUE),
max  = ~max(.x, na.rm = TRUE)
))
)
df_desc
sapply(df, function(x) sum(is.na(x)))
# Chunk 4
df_clean <- df %>%
mutate(mindfulness = if_else(mindfulness > 6, 6, mindfulness)) %>%
mutate(sex = case_when(
sex == "male"   ~ 0,
sex == "female" ~ 1)
)
# Chunk 5
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
# Chunk 6
plot(m0, which = 1)
# Chunk 7
qqnorm(resid(m0))
qqline(resid(m0), col = "red")
shapiro.test(resid(m0))
# Chunk 8
# Chunk 9
lmtest::bptest(m0)
# Chunk 10
car::vif(m0)
# Chunk 11
# Chunk 12
# Chunk 13
# Chunk 14
# Chunk 15
# Chunk 16
# Chunk 17
# Chunk 18
# Chunk 19
lmtest::bptest(m0)
qqnorm(resid(m0))
qqline(resid(m0), col = "red")
shapiro.test(resid(m0))
plot(m0, which = 1)
outlierTest(m0)
View(df_clean)
df_normal <- df_clean[-142, ]
m1 <- lm(pain ~ age + sex, data = df_normal)
qqnorm(resid(m1))
qqline(resid(m1), col = "red")
shapiro.test(resid(m1))
plot(m1, which = 1)
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
plot(m0, which = 1)
outlierTest(m0)
plot(m1, which = 1)
lmtest::bptest(m1)
lmtest::bptest(m1)
lmtest::bptest(m1)
robust_se <- vcovHC(m1, type = "HC3")
library(tidyverse)
library(readxl)
library(car)
library(corrplot)
library(lmtest)
library(sandwich)
lmtest::bptest(m1)
robust_se <- vcovHC(m1, type = "HC3")
lmtest::bptest(m1)
robust_se <- vcovHC(m1, type = "HC3")
coeftest(m1, vcov = robust_se)
plot(m1, which = 1)
View(robust_se)
car::vif(m1)
plot(m1, which = 1)
df_normal <- df_clean[-142, ]
m1 <- lm(pain ~ age + sex, data = df_normal)
outlierTest(m1)
qqnorm(resid(m1))
qqline(resid(m1), col = "red")
shapiro.test(resid(m1))
plot(m1, which = 1)
qqnorm(resid(m1))
qqline(resid(m1), col = "red")
shapiro.test(resid(m1))
plot(m1, which = 1)
lmtest::bptest(m1)
robust_se <- vcovHC(m1, type = "HC3")
coeftest(m1, vcov = robust_se)
qqnorm(resid(m2))
outlierTest(m1)
df_normal2 <- df_normal[-32,]
m2 <- lm(pain ~ age + sex, data = df_normal2)
qqnorm(resid(m2))
qqline(resid(m2), col = "red")
shapiro.test(resid(m2))
plot(m2, which = 1)
lmtest::bptest(m1)
robust_se <- vcovHC(m1, type = "HC3")
coeftest(m1, vcov = robust_se)
lmtest::bptest(m1)
car::vif(m1)
outlierTest(m1)
df_normal2 <- df_normal[-32,]
m2 <- lm(pain ~ age + sex, data = df_normal2)
outlierTest(m2)
outlierTest(m1)
df_normal2 <- df_normal[-32,]
m2 <- lm(pain ~ age + sex, data = df_normal2)
outlierTest(m2)
df_normal3 <- df_normal2[-105,]
m3 <- lm(pain ~ age + sex, data = df_normal3)
qqnorm(resid(m3))
qqline(resid(m3), col = "red")
shapiro.test(resid(m3))
plot(m3, which = 1)
qqnorm(resid(m0))
qqline(resid(m0), col = "red")
shapiro.test(resid(m0))
qqnorm(resid(m0))
qqline(resid(m0), col = "red")
shapiro.test(resid(m0))
lmtest::bptest(m0)
car::vif(m0)
plot(m2, which = 1)
outlierTest(m1)
plot(m1, which = 1)
outlierTest(m1)
qqnorm(resid(m2))
qqline(resid(m2), col = "red")
shapiro.test(resid(m2))
lmtest::bptest(m1)
lmtest::bptest(m0)
lmtest::bptest(m1)
car::vif(m1)
View(df_clean)
m2 <- lm(pain ~ age + sex + STAI_trait + pain_cat + mindfulness + cortisol_serum + cortisol_saliva, data = df_clean)
m2 <- lm(pain ~ age + sex + STAI_trait + pain_cat + mindfulness + cortisol_serum + cortisol_saliva, data = df_clean)
m2
plot(m2, which = 1)
outlierTest(m2)
m2 <- lm(pain ~ age + sex + STAI_trait + pain_cat + mindfulness + cortisol_serum + cortisol_saliva, data = df_normal)
m2
plot(m2, which = 1)
outlierTest(m2)
qqnorm(resid(m1))
qqline(resid(m1), col = "red")
shapiro.test(resid(m1))
qqnorm(resid(m2))
qqline(resid(m2), col = "red")
shapiro.test(resid(m2))
qqnorm(resid(m2))
qqline(resid(m2), col = "red")
shapiro.test(resid(m2))
lmtest::bptest(m2)
car::vif(m2)
anova(m1, m2)
broom::glance(m2)
View(df)
anova(m1, m2)
broom::glance(m1)
broom::glance(m2)
m0 <- lm(pain ~ age + sex, data = df_clean)
m0
df_normal <- df_clean[-142, ]
m1 <- lm(pain ~ age + sex, data = df_normal)
df_normal <- df_clean[-142, ]
m1 <- lm(pain ~ age + sex, data = df_normal)
m1
m2 <- lm(pain ~ age + sex + STAI_trait + pain_cat + mindfulness + cortisol_serum + cortisol_saliva, data = df_normal)
m2
anova(m1, m2)
broom::glance(m1)
broom::glance(m2)
correlation <- cor(
df_clean,
use = "pairwise.complete.obs"
)
View(df_clean)
library(tidyverse)
library(readxl)
library(car)
library(corrplot)
library(lmtest)
library(sandwich)
library(psych)
correlation <- cor(
df_clean,
use = "pairwise.complete.obs"
)
correlation <- cor(
df_clean[, -1],
use = "pairwise.complete.obs"
)
corrplot(correlation, method = "color",
type = "upper",
tl.col = "black",
tl.srt = 45,
addCoef.col = "black",
number.cex = 0.7,
diag = FALSE)
